<?phpinclude_once($_SERVER['DOCUMENT_ROOT'] . '/lib/common.php');$webhelper = new WebHelper();$dbhelper = new dbHelper();$PageUrl = "/admin/manager/list.php";$PageCode = "010101";$webhelper->CheckAdminLogin($PageCode, urlencode($PageUrl), true);//Parameter$page = $webhelper->RequestFilter("page", 0, false);$searchKey = $webhelper->RequestFilter("searchKey", -1, false);$filter = $webhelper->RequestFilter("filter", 0, false);$order = $webhelper->RequestFilter("order", 0, false);//check parameterif($webhelper->isNull($page)) $page = 1;if($webhelper->isNull($searchKey)) $searchKey = "";if($webhelper->isNull($filter)) $filter = 0;if($webhelper->isNull($order)) $order = 0;$Parameter = "&searchKey=$searchKey&filter=$filter&order=$order";$PageSize = 50;$dbhelper->dbOpen();$sql = "select pkid, id, status, isAdministrator, isEditor, isCareers, regdate, logindate from admin where 1=1 ";if($searchKey != ""){    $sql .= " and (id like '%$searchKey%' or email like '%$searchKey%' or firstname like '%$searchKey%' or lastname like '%$searchKey%' )";}if($filter != 0){    switch($filter)    {        case 1:            $sql .= " and isAdministrator = 1";            break;        case 2:            $sql .= " and isEditor = 1";            break;        case 3:            $sql .= " and isCareers = 1";            break;    }}if($order == 0)    $sql .= " order by pkid desc ";if( $order == 1)    $sql .= " order by id desc ";if( $order == 2)    $sql .= " order by id asc ";if( $order == 3)    $sql .= " order by regdate desc ";if( $order == 4)    $sql .= " order by regdate asc ";if( $order == 5)    $sql .= " order by logindate desc ";if( $order == 6)    $sql .= " order by logindate asc ";$List = $dbhelper->RunSQLReturnRowsSub($sql, $page, $PageSize, $TotalCount);$pageList = $webhelper->getPaging($TotalCount, $page, $PageSize);$dbhelper->dbClose();?><?php include_once($_SERVER['DOCUMENT_ROOT'] . '/admin/include/header.php')?>    <script type="text/javascript">        function search()        {            document.searchFrm.submit();        }                function del(pkid)        {            if(confirm("Are you sure you want to delete this record?"))            {                location.href = "/admin/manager/delete.php?pkid="+pkid;            }        }                function modify(pkid)        {            location.href = "/admin/manager/modifyFrm.php?pkid="+pkid+"&page=<?=$page.$Parameter?>";        }                function order(type)        {            var f = document.searchFrm;            if(type == 0)            {                f.order.value = "0";            }            if(type == 1)            {                if(f.order.value == "1")                {                    f.order.value = "2";                }else                {                    f.order.value = "1";                }            }            if(type == 3)            {                if(f.order.value == "3")                {                    f.order.value = "4";                }else                {                    f.order.value = "3";                }            }            if(type == 5)            {                if(f.order.value == "5")                {                    f.order.value = "6";                }else                {                    f.order.value = "5";                }            }                        document.searchFrm.submit();        }    </script>        <div id="container">        <div id="contents">            <h2>Manager List</h2>            <form name="searchFrm" method="get" action="/admin/manager/list.php">                <input type="hidden" name="order" value="<?=$order?>"/>                <div class="form_search">                    <input type="text" name="searchKey" value="<?=$searchKey?>"> <a href="javascript:search();" class="bt bt-green">search</a>                    <a href="/admin/manager/registerFrm.php" class="bt bt-green add_new">ADD NEW</a>                </div>                <!-- //form_search -->                <h3>SHOW ONLY USERS WHERE</h3>                <div class="data_filter">                    <select name="filter">                        <option value="0" <?=$webhelper->MakeSelectedValue("0", $filter)?>>ALL</option>                        <option value="1" <?=$webhelper->MakeSelectedValue("1", $filter)?>>Administrator</option>                        <option value="2" <?=$webhelper->MakeSelectedValue("2", $filter)?>>Editor</option>                        <option value="3" <?=$webhelper->MakeSelectedValue("3", $filter)?>>HR / Careers Editor</option>                    </select>                    <a href="javascript:search();" class="bt bt-navy">filter</a>                </div>                <!-- //data_filter -->            </form>            <table class="board_list">                <colgroup>                    <col style="width:13%">                    <col style="width:12%">                    <col style="width:24%">                    <col style="width:18%">                    <col style="width:18%">                    <col style="width:12%">                </colgroup>                <thead>                <tr>                    <th><a href="javascript:order(1);">Username<?=$order == "1" ? "▲" : ($order == "2" ? "▼" : "")?></a></th>                    <th>Status</th>                    <th>Roles</th>                    <th><a href="javascript:order(3);">Member for<?=$order == "3" ? "▲" : ($order == "4" ? "▼" : "")?></a></th>                    <th><a href="javascript:order(5);">Last access<?=$order == "5" ? "▲" : ($order == "6" ? "▼" : "")?></a></th>                    <th></th>                </tr>                </thead>                <tbody>                <?php                     if($List != null && count($List) > 0)                    {                        $num; $i=0;                        foreach ($List as $row)                        {                            $num = $TotalCount - ($i++) - ($PageSize * ($page - 1));                ?>                    <tr>                        <td><a href="javascript:modify('<?=$row["pkid"]?>');"><?=$row["id"]?></a></td>                        <td><?=$row["status"] == 0 ? "blocked" : "active"?></td>                        <td>                            <ul>                                <?=$row["isAdministrator"] == 0 ? "" : "<li>Administrator</li>"?>                                <?=$row["isEditor"] == 0 ? "" : "<li>Editor</li>"?>                                <?=$row["isCareers"] == 0 ? "" : "<li>HR / Careers Editor</li>"?>                            </ul>                        </td>                        <td><?=$webhelper->HumanTiming($row["regdate"])?></td>                        <td><?=$webhelper->HumanTiming($row["logindate"])?></td>                        <td><a href="javascript:modify('<?=$row["pkid"]?>');">Edit</a>  |  <a href="javascript:del('<?=$row["pkid"]?>');">Delete</a></td>                    </tr>                <?php                        }                    }                    else                    {                ?>                    <tr>                        <td colspan="6" align="center">no data found.</td>                    </tr>                <?php                    }                ?>                </tbody>            </table>            <!-- //board_list -->            <?=$webhelper->GetAdminPageHtml($pageList, $page, $PageUrl, $Parameter, $PageSize)?>            <!-- //pagination -->        </div>        <!-- //contents -->    </div>    <!-- //container --><?php include_once($_SERVER['DOCUMENT_ROOT'] . '/admin/include/footer.php')?>